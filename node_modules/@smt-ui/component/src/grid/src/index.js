/**
 * @file grid
 * @author v_zhaoxinggang
 * @date 2020-07-17
 */

/* global swan */
import {multipleColumnsArr, isIos} from './../../common/utils/index';

Component({ // eslint-disable-line
    externalClasses: ['smt-title-class', 'smt-sub-title-class', 'smt-item-class'],

    properties: {
        // 数据
        list: {
            type: Array,
            value: []
        },

        // horizontal 水平排列、垂直排列 vertical
        type: {
            type: String,
            value: 'vertical'
        },

        // 列数
        columnNum: {
            type: Number,
            value: 2
        },

        // 图片圆角， 单位 rpx
        imgBorderRadius: {
            type: Number,
            value: 3
        },

        // 是否有下边线
        hasBorder: {
            type: Boolean,
            value: true
        },

        // 是否有点击态
        disable: {
            type: Boolean,
            value: false
        },

        // 图片 border
        imageBorder: {
            type: Boolean,
            value: false
        },

        // 是否有分割线
        hasSeparateLine: {
            type: Boolean,
            value: true
        }
    },

    data: {
        // 是否为 ios
        isIos,

        // 组件最终渲染数据
        dataList: [],

        // 规范后的列数，不允许 1 列和超出 4 列，超出按 4 列展示 4 列
        col: 2
    },

    created() {
        const {columnNum, list, type} = this.data;
        let col;
        if (type === 'vertical') {
            col = columnNum < 2 ? 2 : columnNum > 4 ? 4 : columnNum;
        }
        else {
            col = columnNum < 2 ? 2 : columnNum > 3 ? 3 : columnNum;
        }
        this.setData({
            col,
            dataList: multipleColumnsArr(list, col)
        });
    },

    methods: {
        /**
         * 点击事件
         *
         * @param {Object} currentTarget 事件对象
         */
        clickHld({currentTarget}) {
            this.triggerEvent('clickhld', currentTarget.dataset.info);
        }
    }
});
